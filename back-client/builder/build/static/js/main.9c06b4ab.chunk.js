(this["webpackJsonpquestionnaire-maker"]=this["webpackJsonpquestionnaire-maker"]||[]).push([[0],{16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n(1),r=n.n(o),c=n(9),i=n.n(c),s=n(2),l=n.n(s),u=n(4),d=n(6),p=n(8);n(16);var b=function(){var e=Object(o.useState)([{question:"",type:"textbox",options:""}]),t=Object(p.a)(e,2),n=t[0],r=t[1],c=Object(o.useState)([]),i=Object(p.a)(c,2),s=i[0],b=i[1];function j(){var e=new Date,t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0");return e.getFullYear()+"/"+n+"/"+t}function x(){return(x=Object(d.a)(l.a.mark((function e(){var t,a,o,c,i,s,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=Object(u.a)(n)).forEach((function(e){"mc"!==e.type&&"likert"!==e.type&&(e.options="")})),r(t),a=document.getElementById("token").value,o=document.getElementById("name").value,c="",i="",n.forEach((function(e,t){c="textbox"===e.type?c.concat(e.question," varchar(100) "):c.concat(e.question," varchar(10) "),i=i.concat("$".concat(t+1," "))})),"create"!==document.getElementById("selectMode").value){e.next=22;break}return e.prev=9,e.next=12,fetch("/api/v1/buildnewscheme/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a,questionnaire_name:o,active:!0,create_date:j(),modi_date:j(),content_json:t,questionList:c,moneySignList:i})});case 12:s=e.sent,alert("Creation successful! Redirect to review"),window.location.href=s.url,e.next=20;break;case 17:e.prev=17,e.t0=e.catch(9),console.error(e.t0);case 20:e.next=33;break;case 22:return e.prev=22,e.next=25,fetch("/api/v1/editscheme/"+a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a,questionnaire_name:o,active:!0,create_date:j(),modi_date:j(),content_json:t,questionList:c,moneySignList:i})});case 25:d=e.sent,alert("Update successful! Redirect to review"),window.location.href=d.url,e.next=33;break;case 30:e.prev=30,e.t1=e.catch(22),console.error(e.t1);case 33:case"end":return e.stop()}}),e,null,[[9,17],[22,30]])})))).apply(this,arguments)}function h(e,t,a){var o=Object(u.a)(n);o[t][a]=e.target.value,r(o),"type"===a&&"mc"===e.target.value?(e.target.nextSibling.disabled=!1,e.target.nextSibling.placeholder="Seperate MC options with ;"):"type"===a&&"likert"===e.target.value?e.target.nextSibling.disabled=!1:"type"===a&&(e.target.nextSibling.disabled=!0,e.target.nextSibling.placeholder="",r(o))}function m(){var e=function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length,o=0;o<e;o++)t+=n.charAt(Math.floor(Math.random()*a));return t}(8);document.getElementById("token").value=e,s.forEach((function(t){t.token===e?m():document.getElementById("token").value=e}))}var v=function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/v1/get-all-token/");case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,b(n.data),n.data.forEach((function(e,t){var n=document.createElement("option");n.value=e.token,n.innerHTML=e.token+" - "+e.questionnaire_name,document.getElementById("selectMode").add(n)})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,o,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/v1/questionnaire-live/"+t.target.value);case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,o=a.data.content_json,document.getElementById("name").value=a.data.questionnaire_name,document.getElementById("token").value=a.data.token,c=o,console.log(c),console.log(typeof c),r(c),document.querySelectorAll("#typeBox").forEach((function(e){"likert"!==e.value&&"mc"!==e.value||(e.nextSibling.disabled=!1)})),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t){return e.apply(this,arguments)}}();return Object(o.useEffect)((function(){m(),v()}),[]),Object(a.jsxs)("div",{className:"container",style:{margin:"25px"},children:[Object(a.jsx)("h1",{children:"Build a questionnaire"}),Object(a.jsx)("div",{children:"Select questionnaire to edit:"}),Object(a.jsx)("select",{class:"token-dropdown",id:"selectMode",style:{width:"300px"},onChange:function(e){return f(e)},onSelect:function(){(document.getElementById("selectMode").value="create")?document.getElementById("reloadToken").disabled=!1:document.getElementById("reloadToken").disabled=!0},children:Object(a.jsx)("option",{value:"create",children:"Create new questionnaire"})}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)("div",{children:"Questionnaire Name:"}),Object(a.jsx)("input",{type:"text",id:"name",name:"name"}),Object(a.jsx)("div",{children:"Generate random token:"}),Object(a.jsx)("input",{type:"text",id:"token",name:"token",disabled:!0})," ",Object(a.jsx)("button",{id:"reloadToken",onClick:function(){return m()},children:"Reload"}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{style:{margin:"15px",border:"1px solid"},children:[Object(a.jsxs)("div",{style:{margin:"15px"},children:[n.map((function(e,t){return Object(a.jsxs)("div",{style:{margin:"15px"},children:[Object(a.jsx)("input",{type:"text",name:"question",value:e.question,onChange:function(e){return h(e,t,"question")}}),Object(a.jsxs)("select",{name:"type",className:"typeBox",value:e.type,onChange:function(e){return h(e,t,"type")},children:[Object(a.jsx)("option",{value:"textbox",children:"Textbox"}),Object(a.jsx)("option",{value:"mc",children:"Multiple Choice"}),Object(a.jsx)("option",{value:"likert",children:"Likert"})]}),Object(a.jsx)("input",{list:"dropdown-in-detail-"+t,type:"text",name:"options",value:e.options,onChange:function(e){return h(e,t,"options")},disabled:!0}),Object(a.jsxs)("datalist",{id:"dropdown-in-detail-"+t,children:[Object(a.jsx)("option",{value:"1-10",children:"likert 1-10"}),Object(a.jsx)("option",{value:"agree-disagree-5",children:"agree-disagree-5"})]}),Object(a.jsx)("button",{onClick:function(e){return function(e,t){var a=Object(u.a)(n);a.splice(t,0,{question:"",type:"textbox",options:""}),r(a)}(0,t)},children:"+"})]},t)})),Object(a.jsx)("button",{onClick:function(){r([].concat(Object(u.a)(n),[{question:"",type:"textbox",options:""}]))},children:"+"})]}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{})]}),Object(a.jsx)("button",{onClick:function(){return function(){return x.apply(this,arguments)}()},children:"Submit"}),JSON.stringify(n)]})};i.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(b,{})}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.9c06b4ab.chunk.js.map