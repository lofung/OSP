{"version":3,"sources":["App.js","index.js"],"names":["App","useState","title","setTitle","token","setToken","questionList","setQuestionList","getTodayDate","today","Date","dd","String","getDate","padStart","mm","getMonth","getFullYear","submitQ","a","answerList","forEach","item","idx","push","question","answer","name","document","getElementById","value","date","answers","fetch","substring","method","headers","body","JSON","stringify","alert","window","location","href","console","error","generateOptions","options","index","split","filter","map","style","type","onChange","e","checkedboxes","querySelectorAll","values","checkbox","tempAnswerList","changeCheckboxAnswer","htmlFor","recordAnswer","target","changeBlueLine","line","radios","getElementsByClassName","select","width","length","answerSwitch","obj","id","limits","lowerLimit","parseInt","upperLimit","resultArray","k","className","score","getCurrentAddress","address","addressArray","response","json","JSONData","questionData","data","content_json","questionnaire_name","useEffect","disabled","placeholder","onClick","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.a7d54ec1.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport './App.css';\n\nfunction App() {\n  const [title, setTitle] = useState(\"Ordinary Questionnaire (Cannot fetch db - demo)\")\n  const [token, setToken] = useState(\"vkkU2MmK\")\n  const [questionList, setQuestionList] = useState(\n    [{\"question\":\"day?\",\"type\":\"textbox\",\"options\":\"\", \"required\": false, \"answer\": \"\"},\n    {\"question\":\"drinking?\",\"type\":\"mc\",\"options\":\"yes; no; i dunno;\", \"required\": false, \"answer\": \"\"},\n    {\"question\":\"like parents?\",\"type\":\"likert\",\"options\":\"1-10\", \"required\": false, \"answer\": \"\"},\n    {\"question\":\"like hk?\",\"type\":\"likert\",\"options\":\"agree-disagree-5\", \"required\": false, \"answer\": \"\"}]\n    );\n\n  //get the date of today, should have got time also\n  function getTodayDate(){\n    //https://stackoverflow.com/questions/1531093/how-do-i-get-the-current-date-in-javascript\n    let today = new Date();\n    let dd = String(today.getDate()).padStart(2, '0');\n    let mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!\n    let yyyy = today.getFullYear();\n\n    return yyyy + '/' + mm + '/' + dd;\n  }\n\n  //when hitting the submitt button\n  const submitQ = async () => {\n    let answerList = []\n\n    //rebuild the JSON to ease load on database\n    questionList.forEach((item, idx) => {\n      answerList.push({\"question\": item.question, \"answer\": item.answer})\n    })\n    //only get q and a to minimize db load\n\n    const answer = {\n      name: document.getElementById('name').value,\n      date: getTodayDate(),\n      answers: answerList\n    }\n    try {\n      //'token', 'questionnaire_name', 'active', 'create_date', 'modi_date', 'content_JSON', questionList, moneySignList\n      const response = await fetch('/api/v1/postanswers/' + token.substring(0, 8), {\n          method: \"POST\",\n          headers: {\"Content-Type\": \"application/json\"},\n          body: JSON.stringify(answer),\n          \n      });\n      alert(\"input success, thank you for answering!!\")\n      window.location.href = \"/\" \n    } catch (err) {\n      console.error(err);\n    }\n  }\n\n  //load the checked boxes in mc to the JSON of answer\n  const changeCheckboxAnswer = (index, question) => {\n    //https://www.javascripttutorial.net/javascript-dom/javascript-checkbox/\n    const checkedboxes = document.querySelectorAll(`input[name=q${index}]:checked`);\n    //querySelectorAll cannot search special characters!!\n    //console.log(checkedboxes)\n    let values = [];\n    checkedboxes.forEach((checkbox) => {\n        values.push(checkbox.value);\n    });\n    let tempAnswerList = [...questionList]\n    tempAnswerList[index][\"answer\"] = values\n    setQuestionList(tempAnswerList)\n  }\n\n  //generate options for the check boxes\n  const generateOptions = (options, index, question) => {\n    //return options.split(';').map(answer => \"hello world\")\n    //console.log(options.split(';'))\n    return (options.split(\";\").filter(answer => answer!==\"\").map((answer, idx) => \n        <div key={answer+\"-\"+idx} style={{\"margin\": \"5px\"}}>\n          <input type=\"checkbox\" value={answer} name={\"q\"+index} onChange={(e) => changeCheckboxAnswer(index)}/>\n          <label htmlFor={answer}>{answer}</label>\n        </div>\n    ))\n  }\n\n  const recordAnswer = (e, idx) => {\n    //if detect a change in options, immeidately log it in state\n    let tempAnswerList = [...questionList]\n    tempAnswerList[idx][\"answer\"] = e.target.value\n    setQuestionList(tempAnswerList)\n  }\n\n  const changeBlueLine = (e, idx, type) => {\n    //change the blue line length in the likert\n    //NOT PURELY FRONTEND, THERE IS AN TRIGGER TO CHANGE JSON IN THE END!!\n\n    //console.log(idx)\n    const line = document.getElementById(\"q\"+idx+\"line\")\n    const radios = document.getElementsByClassName(\"q\"+idx)\n    let select = e.target.value\n    if (type === \"likert-agree\"){\n      switch(e.target.value){\n        case \"Strongly Disagree\":\n          select = 1; break;\n        case \"Disagree\":\n          select = 2; break;\n        case \"Neutral\":\n          select = 3; break;\n        case \"Agree\":\n          select = 4; break;\n        case \"Strongly Agree\":\n          select = 5; break;\n        default:\n          select = 0; break;\n      }\n      line.style.width = `${77*(select-1)/4}%`\n      //blindly tested values. roughly works\n    }\n    if (type ===\"likert\"){\n      line.style.width = `${90*(select-1)/radios.length}%`\n      //The math for likert looks something wrong. But visually ok. Given up to \"fix\"\n      //console.log(\"select=\"+select)\n      //console.log(\"length=\"+radios.length)\n    }\n    //record answer after changing line\n    recordAnswer(e, idx)\n  }\n\n\n  const answerSwitch = (type, options, index, question) => {\n    // https://stackoverflow.com/questions/46592833/how-to-use-switch-statement-inside-a-react-component/60365434\n    // to resolve different question types for the questionnaire\n    let obj = \"\"\n    switch(type){\n      case \"textbox\":\n        obj = <input type=\"text\" id={\"q\"+index} onChange={(e) => recordAnswer(e, index)}/>\n        break;\n      case \"mc\":\n        //https://www.w3schools.com/tags/att_select_multiple.asp\n        obj = <div id={\"q\"+index}>\n          {generateOptions(options, index, question)}\n        </div>\n        break;\n      case \"likert\":\n        if (options === \"1-10\"){\n          //in case if the likert has to become odd values like 2-15\n          //then replace with Regex\n          let limits = options.split(\"-\")\n          let lowerLimit = parseInt(limits[0])\n          let upperLimit = parseInt(limits[1])\n          let resultArray = []\n          //make likert scale scores\n          for (let k = lowerLimit; k<upperLimit+1; k++) { resultArray.push(k) }\n\n          //old way of writing the code using dropdown\n          //obj = <select name={\"q\"+index} id={\"q\"+index} defaultValue=\"default\" onChange={(e) => recordAnswer(e, index)}>\n          //  <option value=\"default\" disabled>Select</option>\n          //  {resultArray.map(score => <option key={score+\"score\"} value={score}>{score}</option>)}\n          //</select>\n\n          obj = <ul className=\"likert\">\n            <div className=\"line\" id={\"q\"+index+\"line\"} key={\"q\"+index+\"line\"}/>\n            {resultArray.map(score => <li key={score+\"likert\"+index+\"score\"}><input type=\"radio\" className={\"q\"+index} name={\"q\"+index} id={\"q\"+index} onChange={(e) => changeBlueLine(e, index, \"likert\")} value={score} /><label>{score}</label></li>)}\n          </ul>\n\n        }\n        if (options === \"agree-disagree-5\"){\n          let resultArray = [\"Strongly Disagree\", \"Disagree\", \"Neutral\", \"Agree\", \"Strongly Agree\"]\n\n          //old way of writing the code using dropdown\n          //obj = <select name={\"q\"+index} id={\"q\"+index}  defaultValue=\"default\" onChange={(e) => recordAnswer(e, index)}>\n          //  <option value=\"default\" disabled>Select</option>\n          //  {resultArray.map(score => <option key={score+\"agree\"}value={score}>{score}</option>)}\n          //</select>\n\n          obj = <ul className=\"likert-agree\">\n            <div className=\"line-agree\" id={\"q\"+index+\"line\"} key={\"q\"+index+\"line\"}/>\n            {resultArray.map(score => <li key={score+\"agree\"+index+\"score\"} ><input type=\"radio\" className={\"q\"+index} name={\"q\"+index} id={\"q\"+index} onChange={(e) => changeBlueLine(e, index, \"likert-agree\")} value={score} /><label className=\"likert-agree-label\">{score}</label></li>)}\n          </ul>\n\n        }\n        break;\n      //the odd default catch\n      default:\n        obj =\"caught in default, contact developer\"\n        break;\n    }\n    return obj\n  }\n  //idea\n  //https://codepen.io/Buttonpresser/pen/qiuIx?editors=1100\n\n  //get the token in the address link and load the questions\n  const getCurrentAddress = async () => {\n    let address = window.location.href //address that is typed into the client browser\n    //console.log(window.location.href)\n    let addressArray = address.split(\"/\")\n    let token = addressArray[addressArray.length-1] //the token of the q we want to fetch from server\n    //alert(token)\n    setToken(token)\n    \n    //load questions\n    try {\n      const response = await fetch('/api/v1/questionnaire-live/' + token)\n      //console.log(response)\n      //must need this line to get the result of JSON, not some silly stuff\n      const JSONData = await response.json();\n      //console.log(JSONData)\n      const questionData = JSONData.data.content_json\n      //console.log(questionData)\n      setTitle(JSONData.data.questionnaire_name)\n      setToken(JSONData.data.token + \" - load success\")\n      setQuestionList(questionData)\n    } catch (err) {\n      console.error(err)\n    }\n\n  }\n\n  useEffect(() =>{\n    getCurrentAddress()\n  }, []);\n\n  return (\n    <div className=\"container\">\n      <h1>{title}</h1>\n      Token: <input type=\"text\" value={token} disabled />\n      <div className=\"questionnaire-container\" style={{\"border\":\"1px solid\"}}>\n        <br />\n        <span style={{\"margin\": \"10px\"}}>Nickname/alias: <input type=\"text\" id=\"name\" placeholder=\"No real name please!\"/></span>\n        {/* generate questionnaire here */}\n        {questionList.map((data, idx) => \n          <div key={idx+'box'} className={'question-'+idx+'-box'} style={{\"margin\": \"10px\"}}>\n            <div className=\"statement\">{idx+1}. {data.question}</div>\n            {/* generate answer in swtich */}\n            {answerSwitch(data.type, data.options, idx, data.question)}\n          </div>\n        )}\n      </div>\n\n      <button onClick={() => submitQ()}>Submit</button>\n      <br/>{JSON.stringify(questionList)}\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}